<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Arbitrage Radar">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#0a0e17">
    <meta name="description" content="Cross-Exchange Arbitrage Radar - Real-time futures price comparison">
    <title>Arbitrage Radar - Futures</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-tertiary: #1a2332;
            --accent-orange: #ff6b35;
            --accent-yellow: #ffc107;
            --accent-green: #00ff88;
            --accent-red: #ff1744;
            --accent-blue: #2196f3;
            --text-primary: #e0e7ff;
            --text-secondary: #94a3b8;
            --text-muted: #475569;
            --border: #1e293b;
            --glow-orange: rgba(255, 107, 53, 0.3);
            --glow-yellow: rgba(255, 193, 7, 0.3);
        }

        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(45deg, var(--border) 1px, transparent 1px),
                linear-gradient(-45deg, var(--border) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.08;
            z-index: -1;
            animation: gridMove 20s linear infinite;
        }

        @keyframes gridMove {
            0% { background-position: 0 0, 0 0; }
            100% { background-position: 40px 40px, -40px 40px; }
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 15px;
        }

        @media (min-width: 768px) {
            .container {
                padding: 20px;
            }
        }

        .header {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border: 2px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 50px rgba(255, 107, 53, 0.15);
        }

        @media (min-width: 768px) {
            .header {
                padding: 30px;
                margin-bottom: 30px;
            }
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, var(--glow-orange) 0%, transparent 70%);
            opacity: 0.1;
            animation: headerPulse 10s ease-in-out infinite;
        }

        @keyframes headerPulse {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 28px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-orange), var(--accent-yellow));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px var(--glow-orange);
            margin-bottom: 8px;
            letter-spacing: 1px;
            line-height: 1.2;
        }

        @media (min-width: 768px) {
            .logo {
                font-size: 42px;
                margin-bottom: 10px;
                letter-spacing: 2px;
            }
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 15px;
        }

        @media (min-width: 768px) {
            .subtitle {
                font-size: 14px;
                letter-spacing: 3px;
                margin-bottom: 20px;
            }
        }

        /* Exchange Status Indicators */
        .exchange-status-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .exchange-status {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 12px;
            transition: all 0.3s;
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            position: relative;
            transition: all 0.3s;
        }

        .status-dot.loading {
            background: var(--accent-yellow);
            animation: pulse 1.5s ease-in-out infinite;
        }

        .status-dot.online {
            background: var(--accent-green);
            box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .status-dot.offline {
            background: var(--accent-red);
            box-shadow: 0 0 10px rgba(255, 23, 68, 0.5);
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(0.9);
            }
        }

        .status-label {
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .exchange-status.status-online {
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.05);
        }

        .exchange-status.status-offline {
            border-color: var(--accent-red);
            background: rgba(255, 23, 68, 0.05);
        }

        .exchange-status.status-loading {
            border-color: var(--accent-yellow);
            background: rgba(255, 193, 7, 0.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 20px;
                margin-bottom: 30px;
            }
        }

        .stat-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 15px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        @media (min-width: 768px) {
            .stat-card {
                border-radius: 16px;
                padding: 25px;
            }
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(180deg, var(--accent-orange), var(--accent-yellow));
            opacity: 0;
            transition: opacity 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px var(--glow-orange);
            border-color: var(--accent-orange);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-muted);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-orange);
            text-shadow: 0 0 20px var(--glow-orange);
        }

        @media (min-width: 768px) {
            .stat-value {
                font-size: 32px;
            }
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .btn {
            padding: 14px 20px;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            min-height: 44px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        @media (min-width: 768px) {
            .btn {
                padding: 12px 24px;
            }
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: var(--accent-orange);
            opacity: 0.3;
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            border-color: var(--accent-orange);
            box-shadow: 0 0 20px var(--glow-orange);
            transform: translateY(-2px);
        }

        .btn.active {
            background: var(--accent-orange);
            color: var(--bg-primary);
            border-color: var(--accent-orange);
            box-shadow: 0 0 30px var(--glow-orange);
        }

        .btn-text {
            position: relative;
            z-index: 1;
        }

        .filters {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .filters-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            font-weight: 700;
            color: var(--accent-orange);
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .filter-label {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-muted);
            font-weight: 600;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider-value {
            min-width: 80px;
            text-align: right;
            font-weight: 700;
            color: var(--accent-orange);
            font-size: 14px;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            background: var(--bg-tertiary);
            border-radius: 10px;
            outline: none;
            border: 1px solid var(--border);
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--accent-orange);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px var(--glow-orange);
            transition: all 0.2s;
        }

        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 0 20px var(--glow-orange);
        }

        select {
            padding: 12px 15px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            -webkit-appearance: none;
            appearance: none;
            min-height: 44px;
        }

        select:hover, select:focus {
            border-color: var(--accent-orange);
            outline: none;
        }

        .table-container {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .table-header {
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr 1.2fr;
            padding: 20px 25px;
            background: linear-gradient(135deg, var(--bg-tertiary), #0f1419);
            border-bottom: 2px solid var(--border);
            font-weight: 700;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--accent-orange);
        }

        .table-body {
            max-height: 600px;
            overflow-y: auto;
        }

        .table-body::-webkit-scrollbar {
            width: 8px;
        }

        .table-body::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        .table-body::-webkit-scrollbar-thumb {
            background: var(--accent-orange);
            border-radius: 4px;
        }

        .pair-row {
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr 1.2fr;
            padding: 20px 25px;
            border-bottom: 1px solid var(--border);
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .pair-row::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, var(--accent-orange), transparent);
            transition: width 0.3s;
            opacity: 0.1;
        }

        .pair-row:hover {
            background: rgba(255, 107, 53, 0.05);
        }

        .pair-row:hover::before {
            width: 100%;
        }

        .pair-symbol {
            font-weight: 700;
            font-size: 16px;
            color: var(--text-primary);
        }

        .exchange-price {
            color: var(--text-secondary);
            font-size: 13px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .exchange-name {
            font-size: 9px;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 1px;
        }

        .price-value {
            font-weight: 600;
            color: var(--text-primary);
        }

        .spread-cell {
            font-weight: 700;
            font-size: 18px;
        }

        .spread-positive {
            color: var(--accent-green);
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
        }

        .spread-negative {
            color: var(--text-muted);
        }

        .action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: 2px solid;
            font-size: 11px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'JetBrains Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
        }

        .btn-arbitrage {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
        }

        .btn-arbitrage:hover {
            background: var(--accent-green);
            color: var(--bg-primary);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .btn-low {
            background: rgba(148, 163, 184, 0.1);
            border-color: var(--text-muted);
            color: var(--text-muted);
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--border);
            border-top: 4px solid var(--accent-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: rgba(255, 23, 68, 0.1);
            border: 2px solid var(--accent-red);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            color: var(--accent-red);
            font-weight: 600;
        }

        .exchange-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 700;
            margin-left: 8px;
        }

        .badge-bybit {
            background: rgba(255, 193, 7, 0.2);
            color: var(--accent-yellow);
        }

        .badge-mexc {
            background: rgba(33, 150, 243, 0.2);
            color: var(--accent-blue);
        }

        .badge-gateio {
            background: rgba(36, 195, 166, 0.2);
            color: #24c3a6;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }

            .table-header {
                display: none;
            }

            .pair-row {
                grid-template-columns: 1fr;
                gap: 12px;
                padding: 15px;
                border-radius: 12px;
                margin-bottom: 10px;
                background: var(--bg-tertiary);
            }

            .pair-row > div {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 8px 0;
            }

            .pair-row > div::before {
                content: attr(data-label);
                font-size: 11px;
                text-transform: uppercase;
                color: var(--text-muted);
                font-weight: 600;
                letter-spacing: 1px;
            }

            .pair-symbol {
                font-size: 18px !important;
            }

            .action-btn {
                width: 100%;
                padding: 12px;
                font-size: 13px;
            }

            .controls {
                width: 100%;
            }

            .btn {
                flex: 1;
                min-width: 0;
            }

            .filters,
            .table-container {
                border-radius: 12px;
                padding: 15px;
            }

            .table-body {
                max-height: none;
                padding: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--accent-orange);
            border-radius: 8px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 100;
        }

        .tooltip:hover::after {
            opacity: 1;
        }

        .info-banner {
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.1), rgba(255, 193, 7, 0.1));
            border: 2px solid var(--accent-orange);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid var(--accent-orange);
        }

        .info-title {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-orange);
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .info-content {
            color: var(--text-secondary);
            font-size: 13px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header fade-in">
            <div class="header-content">
                <h1 class="logo">üîÑ ARBITRAGE RADAR</h1>
                <p class="subtitle">Cross-Exchange Futures Price Comparison</p>
                <div class="exchange-status-container">
                    <div class="exchange-status" id="bybitStatus" data-exchange="Bybit">
                        <span class="status-dot loading"></span>
                        <span class="status-label">Bybit</span>
                    </div>
                    <div class="exchange-status" id="mexcStatus" data-exchange="MEXC">
                        <span class="status-dot loading"></span>
                        <span class="status-label">MEXC</span>
                    </div>
                    <div class="exchange-status" id="gateioStatus" data-exchange="Gate.io">
                        <span class="status-dot loading"></span>
                        <span class="status-label">Gate.io</span>
                    </div>
                </div>
            </div>
        </header>

        <div class="info-banner fade-in">
            <div class="info-title">üí° –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞—Ä–±–∏—Ç—Ä–∞–∂</div>
            <div class="info-content">
                –ü–æ–∫—É–ø–∞–µ–º –Ω–∞ –±–∏—Ä–∂–µ —Å –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–æ–π ‚Üí –ü—Ä–æ–¥–∞—ë–º –Ω–∞ –±–∏—Ä–∂–µ —Å –≤—ã—Å–æ–∫–æ–π —Ü–µ–Ω–æ–π = –ü—Ä–∏–±—ã–ª—å –æ—Ç —Ä–∞–∑–Ω–∏—Ü—ã (—Å–ø—Ä–µ–¥).
                <br>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ø—Ä–µ–¥ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç–∏: 0.2% (–ø–æ–∫—Ä—ã–≤–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥).
            </div>
        </div>

        <div class="stats-grid fade-in">
            <div class="stat-card">
                <div class="stat-label">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π</div>
                <div class="stat-value" id="totalOpportunities">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–õ—É—á—à–∏–π —Å–ø—Ä–µ–¥</div>
                <div class="stat-value" id="bestSpread">0.00%</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ú–∞–∫—Å. –ø—Ä–∏–±—ã–ª—å</div>
                <div class="stat-value" id="maxProfit">$0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞—Ä</div>
                <div class="stat-value" id="totalPairs">0</div>
            </div>
        </div>

        <div class="controls fade-in">
            <button class="btn" id="refreshBtn">
                <span class="btn-text">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</span>
            </button>
            <button class="btn" id="autoBtn">
                <span class="btn-text">‚ñ∂Ô∏è –ê–≤—Ç–æ</span>
            </button>
        </div>

        <div class="filters fade-in">
            <h3 class="filters-title">‚öôÔ∏è –§–∏–ª—å—Ç—Ä—ã</h3>
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–ø—Ä–µ–¥ (%)</label>
                    <div class="slider-container">
                        <input type="range" id="minSpreadSlider" min="0" max="2" step="0.05" value="0.2">
                        <span class="slider-value" id="minSpreadValue">0.20%</span>
                    </div>
                </div>
                <div class="filter-group">
                    <label class="filter-label">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</label>
                    <select id="sortSelect">
                        <option value="spread">–ü–æ —Å–ø—Ä–µ–¥—É (‚Üì)</option>
                        <option value="spread_asc">–ü–æ —Å–ø—Ä–µ–¥—É (‚Üë)</option>
                        <option value="profit">–ü–æ –ø—Ä–∏–±—ã–ª–∏ (‚Üì)</option>
                        <option value="symbol">–ü–æ —Å–∏–º–≤–æ–ª—É (A-Z)</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">–ö–∞–ø–∏—Ç–∞–ª –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞</label>
                    <select id="capitalSelect">
                        <option value="1000">$1,000</option>
                        <option value="5000" selected>$5,000</option>
                        <option value="10000">$10,000</option>
                        <option value="50000">$50,000</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="table-container fade-in">
            <div class="table-header">
                <div>–°–∏–º–≤–æ–ª</div>
                <div>Bybit</div>
                <div>MEXC</div>
                <div>Gate.io</div>
                <div>–°–ø—Ä–µ–¥</div>
                <div>–î–µ–π—Å—Ç–≤–∏–µ</div>
            </div>
            <div class="table-body" id="tableBody">
                <div class="loading">
                    <div class="spinner"></div>
                    <div>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const CONFIG = {
            BYBIT_API: 'https://api.bybit.com/v5/market/tickers?category=linear',
            MEXC_API: 'https://contract.mexc.com/api/v1/contract/ticker',
            // Gate.io —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π Vercel/Netlify URL)
            GATEIO_API: 'https://your-project.vercel.app/api/gateio',
            // –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –∏–∑-–∑–∞ CORS):
            // GATEIO_API: 'https://api.gateio.ws/api/v4/futures/usdt/contracts',
            REFRESH_INTERVAL: 30000, // 30 seconds
            MIN_SPREAD_THRESHOLD: 0.2, // 0.2% minimum for profitability
            FEE_MAKER: 0.02, // 0.02% maker fee
            FEE_TAKER: 0.055, // 0.055% taker fee
            TRANSFER_FEE: 0.05 // 0.05% transfer fee estimate
        };

        const state = {
            bybitPrices: {},
            mexcPrices: {},
            gateioPrices: {},
            exchangeStatus: {
                bybit: 'loading',
                mexc: 'loading',
                gateio: 'loading'
            },
            opportunities: [],
            filteredOpportunities: [],
            autoRefresh: false,
            autoRefreshTimer: null,
            filters: {
                minSpread: 0.2,
                sortBy: 'spread',
                capital: 5000
            }
        };

        const elements = {
            totalOpportunities: document.getElementById('totalOpportunities'),
            bestSpread: document.getElementById('bestSpread'),
            maxProfit: document.getElementById('maxProfit'),
            totalPairs: document.getElementById('totalPairs'),
            refreshBtn: document.getElementById('refreshBtn'),
            autoBtn: document.getElementById('autoBtn'),
            minSpreadSlider: document.getElementById('minSpreadSlider'),
            minSpreadValue: document.getElementById('minSpreadValue'),
            sortSelect: document.getElementById('sortSelect'),
            capitalSelect: document.getElementById('capitalSelect'),
            tableBody: document.getElementById('tableBody')
        };

        function updateExchangeStatus(exchange, status) {
            state.exchangeStatus[exchange] = status;
            
            const statusElement = document.getElementById(`${exchange}Status`);
            if (!statusElement) return;
            
            const dot = statusElement.querySelector('.status-dot');
            
            // Remove all status classes
            dot.classList.remove('loading', 'online', 'offline');
            statusElement.classList.remove('status-loading', 'status-online', 'status-offline');
            
            // Add new status
            dot.classList.add(status);
            statusElement.classList.add(`status-${status}`);
            
            // Update tooltip
            const statusText = {
                loading: '–ó–∞–≥—Ä—É–∑–∫–∞...',
                online: '–û–Ω–ª–∞–π–Ω',
                offline: '–û—Ñ–ª–∞–π–Ω'
            };
            statusElement.title = `${statusElement.dataset.exchange}: ${statusText[status]}`;
        }

        async function loadBybitPrices() {
            try {
                updateExchangeStatus('bybit', 'loading');
                const response = await fetch(CONFIG.BYBIT_API);
                if (!response.ok) throw new Error('Bybit API error');
                const data = await response.json();
                
                state.bybitPrices = {};
                data.result.list.forEach(item => {
                    if (item.symbol.endsWith('USDT')) {
                        const symbol = item.symbol.replace('USDT', '_USDT');
                        state.bybitPrices[symbol] = parseFloat(item.lastPrice) || 0;
                    }
                });
                updateExchangeStatus('bybit', 'online');
                console.log('‚úÖ Bybit prices loaded:', Object.keys(state.bybitPrices).length);
            } catch (error) {
                console.error('‚ùå Bybit error:', error);
                updateExchangeStatus('bybit', 'offline');
            }
        }

        async function loadMexcPrices() {
            try {
                updateExchangeStatus('mexc', 'loading');
                const response = await fetch(CONFIG.MEXC_API);
                if (!response.ok) throw new Error('MEXC API error');
                const data = await response.json();
                
                state.mexcPrices = {};
                if (data.data && Array.isArray(data.data)) {
                    data.data.forEach(item => {
                        if (item.symbol && item.symbol.endsWith('_USDT')) {
                            state.mexcPrices[item.symbol] = parseFloat(item.lastPrice) || 0;
                        }
                    });
                }
                updateExchangeStatus('mexc', 'online');
                console.log('‚úÖ MEXC prices loaded:', Object.keys(state.mexcPrices).length);
            } catch (error) {
                console.error('‚ùå MEXC error:', error);
                updateExchangeStatus('mexc', 'offline');
            }
        }

        async function loadGateioPrices() {
            try {
                updateExchangeStatus('gateio', 'loading');
                const response = await fetch(CONFIG.GATEIO_API);
                if (!response.ok) throw new Error('Gate.io API error');
                const data = await response.json();
                
                state.gateioPrices = {};
                if (Array.isArray(data)) {
                    data.forEach(item => {
                        if (item.name && item.name.endsWith('_USDT')) {
                            state.gateioPrices[item.name] = parseFloat(item.mark_price) || 0;
                        }
                    });
                }
                updateExchangeStatus('gateio', 'online');
                console.log('‚úÖ Gate.io prices loaded:', Object.keys(state.gateioPrices).length);
            } catch (error) {
                console.error('‚ùå Gate.io error:', error);
                updateExchangeStatus('gateio', 'offline');
            }
        }

        async function loadAllData() {
            elements.tableBody.innerHTML = '<div class="loading"><div class="spinner"></div><div>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –±–∏—Ä–∂...</div></div>';
            
            try {
                await Promise.all([
                    loadBybitPrices(),
                    loadMexcPrices(),
                    loadGateioPrices()
                ]);

                calculateArbitrageOpportunities();
                applyFilters();
                updateStats();
            } catch (error) {
                console.error('Error loading data:', error);
                elements.tableBody.innerHTML = `
                    <div class="error">
                        ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö
                        <br><br>
                        –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.
                        <br><br>
                        <button class="btn" onclick="loadAllData()" style="margin-top: 15px; background: var(--accent-orange); color: white; border: none;">
                            üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                        </button>
                    </div>
                `;
            }
        }

        function calculateArbitrageOpportunities() {
            state.opportunities = [];
            
            // Get all common symbols
            const allSymbols = new Set([
                ...Object.keys(state.bybitPrices),
                ...Object.keys(state.mexcPrices),
                ...Object.keys(state.gateioPrices)
            ]);

            allSymbols.forEach(symbol => {
                const bybitPrice = state.bybitPrices[symbol] || 0;
                const mexcPrice = state.mexcPrices[symbol] || 0;
                const gateioPrice = state.gateioPrices[symbol] || 0;

                // Need at least 2 exchanges with prices
                const prices = [bybitPrice, mexcPrice, gateioPrice].filter(p => p > 0);
                if (prices.length < 2) return;

                // Find min and max prices
                const minPrice = Math.min(...prices.filter(p => p > 0));
                const maxPrice = Math.max(...prices);

                if (minPrice === 0 || maxPrice === 0) return;

                // Calculate spread percentage
                const spread = ((maxPrice - minPrice) / minPrice) * 100;

                // Find which exchanges have min/max
                let buyExchange = '';
                let sellExchange = '';

                if (bybitPrice === minPrice) buyExchange = 'Bybit';
                else if (mexcPrice === minPrice) buyExchange = 'MEXC';
                else if (gateioPrice === minPrice) buyExchange = 'Gate.io';

                if (bybitPrice === maxPrice) sellExchange = 'Bybit';
                else if (mexcPrice === maxPrice) sellExchange = 'MEXC';
                else if (gateioPrice === maxPrice) sellExchange = 'Gate.io';

                // Calculate potential profit (after fees)
                const totalFees = (CONFIG.FEE_TAKER * 2) + CONFIG.TRANSFER_FEE; // ~0.16%
                const netSpread = spread - totalFees;

                if (netSpread > 0.05) { // At least 0.05% profit after fees
                    state.opportunities.push({
                        symbol: symbol,
                        bybitPrice: bybitPrice,
                        mexcPrice: mexcPrice,
                        gateioPrice: gateioPrice,
                        minPrice: minPrice,
                        maxPrice: maxPrice,
                        spread: spread,
                        netSpread: netSpread,
                        buyExchange: buyExchange,
                        sellExchange: sellExchange
                    });
                }
            });

            console.log(`‚úÖ Found ${state.opportunities.length} arbitrage opportunities`);
        }

        function applyFilters() {
            let filtered = [...state.opportunities];

            // Filter by minimum spread
            filtered = filtered.filter(opp => opp.spread >= state.filters.minSpread);

            // Sort
            filtered.sort((a, b) => {
                switch(state.filters.sortBy) {
                    case 'spread':
                        return b.spread - a.spread;
                    case 'spread_asc':
                        return a.spread - b.spread;
                    case 'profit':
                        return (b.netSpread * state.filters.capital / 100) - (a.netSpread * state.filters.capital / 100);
                    case 'symbol':
                        return a.symbol.localeCompare(b.symbol);
                    default:
                        return 0;
                }
            });

            state.filteredOpportunities = filtered;
            renderOpportunities();
        }

        function renderOpportunities() {
            if (state.filteredOpportunities.length === 0) {
                elements.tableBody.innerHTML = '<div class="loading">–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º</div>';
                return;
            }

            let html = '';

            state.filteredOpportunities.forEach(opp => {
                const profit = (opp.netSpread / 100) * state.filters.capital;
                const displaySymbol = opp.symbol.replace('_USDT', '/USDT');

                html += `
                    <div class="pair-row">
                        <div class="pair-symbol" data-label="–°–∏–º–≤–æ–ª">
                            ${displaySymbol}
                        </div>
                        <div class="exchange-price" data-label="Bybit">
                            <span class="exchange-name">Bybit</span>
                            <span class="price-value">${opp.bybitPrice > 0 ? '$' + formatNumber(opp.bybitPrice) : '-'}</span>
                        </div>
                        <div class="exchange-price" data-label="MEXC">
                            <span class="exchange-name">MEXC</span>
                            <span class="price-value">${opp.mexcPrice > 0 ? '$' + formatNumber(opp.mexcPrice) : '-'}</span>
                        </div>
                        <div class="exchange-price" data-label="Gate.io">
                            <span class="exchange-name">Gate.io</span>
                            <span class="price-value">${opp.gateioPrice > 0 ? '$' + formatNumber(opp.gateioPrice) : '-'}</span>
                        </div>
                        <div class="spread-cell ${opp.spread >= state.filters.minSpread ? 'spread-positive' : 'spread-negative'}" data-label="–°–ø—Ä–µ–¥">
                            ${opp.spread.toFixed(2)}%
                        </div>
                        <div data-label="–î–µ–π—Å—Ç–≤–∏–µ">
                            <button class="action-btn ${opp.spread >= state.filters.minSpread ? 'btn-arbitrage' : 'btn-low'} tooltip" 
                                    data-tooltip="–ü—Ä–∏–±—ã–ª—å: $${profit.toFixed(2)}"
                                    onclick="showArbitrageDetails('${opp.symbol}', ${opp.minPrice}, ${opp.maxPrice}, '${opp.buyExchange}', '${opp.sellExchange}', ${opp.spread}, ${profit})">
                                üí∞ ${profit >= 10 ? profit.toFixed(0) : profit.toFixed(2)}$
                            </button>
                        </div>
                    </div>
                `;
            });

            elements.tableBody.innerHTML = html;
        }

        function updateStats() {
            elements.totalOpportunities.textContent = state.filteredOpportunities.length;
            elements.totalPairs.textContent = state.opportunities.length;

            if (state.filteredOpportunities.length > 0) {
                const bestOpp = state.filteredOpportunities[0];
                elements.bestSpread.textContent = bestOpp.spread.toFixed(2) + '%';
                
                const maxProfit = (bestOpp.netSpread / 100) * state.filters.capital;
                elements.maxProfit.textContent = '$' + maxProfit.toFixed(2);
            } else {
                elements.bestSpread.textContent = '0.00%';
                elements.maxProfit.textContent = '$0';
            }
        }

        function formatNumber(num) {
            if (num >= 1000) {
                return num.toLocaleString('ru-RU', { 
                    minimumFractionDigits: 0, 
                    maximumFractionDigits: 2 
                });
            }
            return num.toLocaleString('ru-RU', { 
                minimumFractionDigits: 2, 
                maximumFractionDigits: 6 
            });
        }

        function showArbitrageDetails(symbol, minPrice, maxPrice, buyExchange, sellExchange, spread, profit) {
            const displaySymbol = symbol.replace('_USDT', '');
            const capital = state.filters.capital;
            const quantity = capital / minPrice;
            const totalFees = capital * ((CONFIG.FEE_TAKER * 2 + CONFIG.TRANSFER_FEE) / 100);

            alert(
                `üîÑ –ê–†–ë–ò–¢–†–ê–ñ–ù–ê–Ø –í–û–ó–ú–û–ñ–ù–û–°–¢–¨: ${displaySymbol}\n\n` +
                `–°–¢–†–ê–¢–ï–ì–ò–Ø:\n` +
                `1Ô∏è‚É£ –ö—É–ø–∏—Ç—å –Ω–∞ ${buyExchange}: $${minPrice.toFixed(4)}\n` +
                `2Ô∏è‚É£ –ü—Ä–æ–¥–∞—Ç—å –Ω–∞ ${sellExchange}: $${maxPrice.toFixed(4)}\n` +
                `3Ô∏è‚É£ –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –º–µ–∂–¥—É –±–∏—Ä–∂–∞–º–∏\n\n` +
                `–†–ê–°–ß–Å–¢ –° –ö–ê–ü–ò–¢–ê–õ–û–ú $${capital}:\n` +
                `‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${quantity.toFixed(4)} ${displaySymbol}\n` +
                `‚Ä¢ –°–ø—Ä–µ–¥: ${spread.toFixed(2)}%\n` +
                `‚Ä¢ –ö–æ–º–∏—Å—Å–∏–∏: -$${totalFees.toFixed(2)} (~0.16%)\n` +
                `‚Ä¢ –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å: $${profit.toFixed(2)}\n\n` +
                `‚ö†Ô∏è –†–ò–°–ö–ò:\n` +
                `‚Ä¢ –í—Ä–µ–º—è –ø–µ—Ä–µ–≤–æ–¥–∞ (—Ü–µ–Ω–∞ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è)\n` +
                `‚Ä¢ –ö–æ–º–∏—Å—Å–∏–∏ —Å–µ—Ç–∏ (Gas fees)\n` +
                `‚Ä¢ –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏\n\n` +
                `üí° –°–û–í–ï–¢: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ —Å–µ—Ç–∏ (TRC20, BSC)`
            );
        }

        function setupEvents() {
            elements.refreshBtn.addEventListener('click', loadAllData);

            elements.autoBtn.addEventListener('click', () => {
                state.autoRefresh = !state.autoRefresh;
                elements.autoBtn.classList.toggle('active', state.autoRefresh);

                if (state.autoRefresh) {
                    state.autoRefreshTimer = setInterval(loadAllData, CONFIG.REFRESH_INTERVAL);
                    elements.autoBtn.querySelector('.btn-text').textContent = '‚è∏Ô∏è –°—Ç–æ–ø';
                } else {
                    clearInterval(state.autoRefreshTimer);
                    elements.autoBtn.querySelector('.btn-text').textContent = '‚ñ∂Ô∏è –ê–≤—Ç–æ';
                }
            });

            elements.minSpreadSlider.addEventListener('input', (e) => {
                const value = parseFloat(e.target.value);
                state.filters.minSpread = value;
                elements.minSpreadValue.textContent = value.toFixed(2) + '%';
                applyFilters();
            });

            elements.sortSelect.addEventListener('change', (e) => {
                state.filters.sortBy = e.target.value;
                applyFilters();
            });

            elements.capitalSelect.addEventListener('change', (e) => {
                state.filters.capital = parseInt(e.target.value);
                applyFilters();
            });
        }

        function init() {
            console.log('üöÄ Arbitrage Radar initialized');
            setupEvents();
            loadAllData();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
